<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil</title>
</head>
<body>
    <h1>Mon Profil</h1>
    <p><strong>Nom d'utilisateur:</strong> <span id="username"></span></p>
    <p><strong>Email:</strong> <span id="email"></span></p>
    <p><strong>Rôle:</strong> <span id="role"></span></p>
    <p><strong>Date de naissance:</strong> <span id="dateOfBirth"></span></p>
    <p><strong>Statut:</strong> <span id="status"></span></p>
    <p><strong>Adresse:</strong> <span id="cityAddress"></span></p>
    <p id="jobField" style="display: none;"><strong>Métier:</strong> <span id="job"></span></p>

    <script>
        console.log('Profile page');
        const token = localStorage.getItem('token');
        console.log(token);
        let payload;
        if (token) {
            payload = JSON.parse(atob(token.split('.')[1]));
            console.log('User ID:', payload.id);
        } else {
            console.log('No token found');
        }

        async function fetchData() {
            const response = await fetch('/api/user', {
                headers: { 'Authorization': `Bearer ${token}` },
                body: JSON.stringify({ id: payload.id })
            });

            if (response.ok) {
                const data = await response.json();
                console.log(data);
            } else {
                alert('Login failed');
            }
        }

        fetchData();


        // .then(data => {
        //     document.getElementById('username').textContent = data.username;
        //     document.getElementById('email').textContent = data.email;
        //     document.getElementById('role').textContent = data.role;
        //     document.getElementById('dateOfBirth').textContent = data.dateOfBirth;
        //     document.getElementById('status').textContent = data.status;
        //     document.getElementById('cityAddress').textContent = data.cityAddress;

        //     // Afficher le métier seulement si l'utilisateur est un professionnel
        //     if (data.role === 'professionnel' && data.job) {
        //         document.getElementById('job').textContent = data.job;
        //         document.getElementById('jobField').style.display = "block";
        //     }
        // })
        // .catch(error => console.error('Erreur:', error));
    </script>
</body>
</html>
